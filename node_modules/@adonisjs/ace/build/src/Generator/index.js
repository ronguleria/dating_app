"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const fs_extra_1 = require("fs-extra");
const fancy_logs_1 = __importDefault(require("@poppinss/fancy-logs"));
const File_1 = require("./File");
class Generator {
    constructor(_destinationDir) {
        this._destinationDir = _destinationDir;
        this._files = [];
    }
    addFile(name, options) {
        const file = new File_1.GeneratorFile(name, options);
        if (this._destinationDir) {
            file.destinationDir(this._destinationDir);
        }
        this._files.push(file);
        return file;
    }
    async run() {
        for (let file of this._files) {
            const fileJSON = file.toJSON();
            const exists = await fs_extra_1.pathExists(fileJSON.filepath);
            if (exists) {
                fancy_logs_1.default.skip(`${fileJSON.relativepath} already exists`);
                return;
            }
            await fs_extra_1.outputFile(fileJSON.filepath, fileJSON.contents);
            fancy_logs_1.default.create(fileJSON.relativepath);
        }
    }
    clear() {
        this._files = [];
    }
}
exports.Generator = Generator;
